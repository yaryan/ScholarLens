--- Page 1 --- DIPOLE-LETS: A NEW MULTISCALE DECOMPOSITION FOR MR PHASE AND QUANTITATIVE SUSCEPTIBILITY MAPPING APREPRINT IgnacioContreras-Zúñiga MathiasLambert BiomedicalImagingCenter DepartmentofElectricalEngineering PontificiaUniversidadCatólicadeChile BiomedicalImagingCenter  PontificiaUniversidadCatólicadeChile  BenjamínPalacios CristianTejos DepartmentofMathematics DepartmentofElectricalEngineering PontificiaUniversidadCatólicadeChile BiomedicalImagingCenter  MillenniumInstituteforIntelligentHealthcareEngineering PontificiaUniversidadCatólicadeChile  CarlosMilovic DepartmentofElectricalEngineering BiomedicalImagingCenter PontificiaUniversidadCatólicadeChile  October29,2025 ABSTRACT Identifyingandsuppressingstreakingartifactsisoneofthemostchallengingproblemsinquanti- tativesusceptibilitymapping. Themeasuredphasefromtissuemagnetizationisassumedtobethe convolutionbythemagneticdipolekernel;directinversionorstandardregularizationmethodstend tocreatestreakingartifactsintheestimatedsusceptibility. Thisiscausedbyextremenoiseandbythe presenceofnon-dipolarphasecontributions,whichareamplifiedbythedipolekernelfollowingthe streakingpattern. Inthiswork,weintroduceamultiscaletransform,calledDipole-lets,asanoptimal decompositionmethodforidentifyingdipoleincompatibilitiesinmeasuredfielddatabyextracting featuresofdifferentcharacteristicsizeandorientationwithrespecttothedipolekernel’szero-valued double-cone surface (the magic cone). We provide experiments that showcase that non-dipolar contentcanbeextractedbyDipole-letsfromphasedatathroughartifactlocalization. Wealsopresent implementationsofDipole-letsasaoptimizationfunctionalregularizator,throughsimpleTikhonov andinfinitynorm. Thispreprintisaworkinprogressandisnotthefinalmanuscriptforsubmission. Keywords QuantitativeSusceptibilyMapping·MultiscaleAnalysis·InverseProblems·Electro-Magneticpropertiesof Tissues·MagneticResonanceImaging 5202 tcO 82 ]VI.ssee[ 1v50742.0152:viXra --- Page 2 --- Dipole-letsforMRPhaseandQSM APREPRINT 1 Introduction 1.1 QuantitativeSusceptibilityMapping In gradient-echo MRI, the phase evolves proportionally to magnetic field perturbations. Assuming that this arises fromtissuemagnetization,QuantitativeSusceptibilityMapping(QSM)estimatesthespatialdistributionofmagnetic susceptibilitybyinvertingaconvolutionalmodelinwhichsourcesbehaveasnon-interactingdipoles. Givenalocal magnetizationfieldB ,thiscanbeestimatedbyconvolvingbythespatialsusceptibilitydistributionχ[1],[2]: obj (cid:90) B (x)= d(x−x′)χ(x′)dx′ obj R3 wherex=(x,y,z),x′ =(x′,y′,z′)∈R3. InFourierspace,theconvolutionbecomes: B(cid:100)obj(ξ)=D(ξ)χ (cid:98)(ξ) whereξ =(ξ ,ξ ,ξ )∈R3,andtheFouriertransformofthedipolekernelis: x y z 1 ξ2 D(ξ)= − z , ξ ∈R3\{0} 3 |ξ|2 Thekernelvanishesintheso-called“magiccone/zerocone”: Γ =(cid:8) ξ ∈R3 :ξ2+ξ2 =2ξ2(cid:9) 0 x y z Thus,directinversionoftheequationintheFourierspacesisill-posedandleadstolossofinformation. Afirstapproach atsolvingtheproblemisdefiningainverseavoidingthezerosetbytruncationatacertainthreshold,theTruncated K-SpaceDivision(TKD)[3]isdefinedas 1 χT hKD =B(cid:100)obj(ξ) {| DD( (ξ ξ)≥ )h} where1 istheindicatorfunctionofthesupportregionΩ. Iftheinputdataisnotcleanandiscorruptedby,forexample, Ω noise, phasejumps, orunwrappingerrors, theestimatedsusceptibilitycanbedegradedby“streakingartifacts”, or double-conepatterns[2],[4],[5]. Moreadvancedapproachestoestimatesusceptibilityincludeminimizingadata-fidelitytermandaregularizerthat promotesacharacteristicoftheestimatedsusceptibility,suchasVariationalminimizations[6],duetotheirabilityto promotepiece-wisecontinuousorpiece-wisesmoothsolutions. Regularizationbasedonmultiscaletransformshasalso beenusedinthiscontext[1],[7],[8],[9]. Regularizersbasedonthree-dimensionalseparablewaveletscanintroduce undesiredartifactsorunderperformcomparedtoTVormoretoredundanttransforms. Undecimatedwavelettransforms [10], [11]aremorerobusttothesetypesofartifactsbutarenotdesignedtocaptureanisotropiccontent. Shearlets [12],[13]outperformpriormethodsontheQSMChallengedataandareanoptimaldecompositionforedgedetection. However,theirvolumetrictillingdesigndoesnotmatchtheconephysics,whichisthesourceofstreaking. 1.2 Ournovelmethodology Inourapproach,weintroduceanundecimatedmultiscaletransformtailoredforanalyzinglocalphaseandQSMdata calledDipole-lets. Dipole-letsimprovedoncapturinganisotropiccontentinQSMbyconsideringwindowsorganized bytheirproximitytothemagiccone • Weuselevel-setsof|D(ξ)|togenerateangularbands,asnear-conebands,capturingill-conditionregionsin frequency,thusprovidingawaytoidentifyandpenalizethesourceofstreakingartifacts • Bycouplingittoanundecimatedwavelettransform,italsogivesusper-scaleanalysisofnon-dipolarcontent presentontheinputphase,thusprovidingmoredegreesoffreedomandenablingclearseparation. • Asitisbasedonwavelets,itisfriendlytobeusedasaregularizerforreconstruction. 2 Methods 2.1 Theory Throughoutthiswork,weassumethattheinputlocalphasecanbedecomposedas ψ =ψ +ψ 0 ∗ whereψ isthedipolecompatiblepart,compactlysupporteddistributionintheregionofinterest,ψ =D∗χ . χ 0 0 0 0 isthesusceptibilitywewanttorecover,soψ(cid:98)0(ξ)=0forξ ∈Γ 0. Andadipole-incompatiblepartψ ∗,ψ(cid:99)∗(ξ)̸=0for ξ ∈Γ 0 2 --- Page 3 --- Dipole-letsforMRPhaseandQSM APREPRINT 2.1.1 Dipole-letConstructionforQSM Wecanconstructafamilyofgeometry-informedmultipliersink-spacebythatselectingangularsectionsfollowingthe levelsetofthedipolekernel,andradialsectionsforscalecontrol. ThesewillbesmoothwindowsinFourier-domain. WeusethefollowingconventionfortheFouriertransform[14]: (cid:90) (cid:90) f(cid:98)(ξ):=F(f)(ξ)= f(x)e−2πiξ·xdx, F−1(f(cid:98))(x)= f(cid:98)(ξ)e2πiξ·xdξ R3 R3 2.1.2 RadialDecomposition WerecallpropertiesoftheStarlettransform.Let{Φ }J+1beafamilyofsmoothradiallow-passfilter,withΦ (|ξ|)= j j=0 j+1 Φ (2|ξ|),whichsatisfies: j • Φ (|ξ|)≡1 0 • Φ :[0,∞)→[0,1]smoothandnon-increasing j • lim Φ (|ξ|)=0forall|ξ|>0 j→∞ j Defineradialband-passfilters Ψ (|ξ|):=Φ (|ξ|)−Φ (|ξ|)≥0, j =0,...,J j j j+1 andwedenoteasΦ thecoarseapproximationbandorlow-passresidual. Withtheseconditionsthesefilterssatisfya J+1 partitionofunity J (cid:88) Φ (|ξ|)+ Ψ (|ξ|)≡1, ∀ξ ∈R3{0} J+1 j j=0 whichenablestohaveanexactreconstruction. Forf ∈L2(R3), J (cid:88) f =c + w J+1 j j=0 wherew j :=F−1(Ψ j(|ξ|)f(cid:98)(ξ))arethewavelet/detailcoefficientsinimagespaceandc J+1 :=F−1(Φ J+1(|ξ|)f(cid:98)(ξ)) isthecoarseapproximation. 2.1.3 AngularWindow Fix thresholds 0 = δ < δ < ...δ ≤ 1/3. and transition widths {ε }M−1. Let η : R → [0,1] be a smooth 0 1 M−1 i i=0 transitionsfunctionswithlim η(t) = 0andlim η(t) = 1. Definesmoothangulardiscsindexedbythe t→−∞ t→+∞ absolutevalueofthedipole: (cid:18) (cid:19) δ −|D(ξ)| A (ξ):=η m , m=0,...M −1 m ε m Defineangularwindowsasthedifferencebetweendiscs W (ξ):=A (ξ)−A (ξ), m=0,...,M m m m−1 withtheconventionA ≡ 0andA ≡ 1. ThisconstructionisscaleinvariantasD(λξ) = D(ξ)forλ > 0, but −1 M choiceofη(gaussianfunction,compactlysupportbump)andε controlsthesharpnessofthetransition. m Thewindowsaresmoothawayfromzero,W ∈C∞(R3\{0}),0≤W ≤1andaresupportedontubes m m supp(W )⊂Γ :={ξ ∈R3\{0}:δ −ε ≤|D(ξ)|≤δ +ε } m m m−1 m−1 m m Thisdefinitioncapturesthephysicistofthedipole: • Inm = 0thewindowsconcentratesnearesttothecone|D| ≤ δ andcapturefrequenciesthataredipole- 0 incompatible • Form=M theyconcentratefarfromthecone|D|≥δ ,wheretheconvolutionequationis,inprinciple, m−1 invertible • Andfor1≤m≤M −1areintermediateannularbandsformoreangularcontrol. • Asthewindowsaresmoothandhasnosharpcutt-offs,theydonotintroduceanyextraartifacts 3 --- Page 4 --- Dipole-letsforMRPhaseandQSM APREPRINT Wenormalizetogetapartitionofunity W W(cid:102)m := (cid:80)M Wm (ξ) n=0 n Thismakes(cid:80)M m W(cid:102)(ξ)=1forallξ ∈R3\{0}. FromnowonwewilldenoteasW mthenormalizedwindow. These formulasapplyforallξ ∈ R3\{0}. Inpractice,thelow-passΨ capturesaaneighborhoodofzero,butinour J+1 experimentdonotsplitthecoarseband,onlythedetailones. 2.1.4 Combined-windowsandcoefficients Foreachscalej fixangularwindowsW(j). Definethecombinedangularandradialwindow m W :=Ψ W(j) j,m j m whereWj istheangularwindowatscalej. Forf ∈L2(R3)definethedipole-letscoefficients: m D j,mf(x):=F−1(W j,mf(cid:98)), j =0,...,J,m=0,...,M j andthecoarsescale D J+1f :=F−1(Ψ J+1f(cid:98)) Noticebyconstruction J Mj (cid:88) (cid:88) Φ (|ξ|)+ Ψ (|ξ|) W(j)(ξ)=1 J+1 j m j=0 m=0 Andforeveryf theysatisfiestheperfectreconstructionformulabyaddingthecoarsescaleandthedetailsimages J Mj (cid:88) (cid:88) f =D f + D f J+1 j,m j=0m=0 2.1.5 Relationshipwithartifacts Theangulardecompositionisbasedonthelevelsetsof|D|,soitrespectsthegeometryofthedipole;structuresaligned withthemagicconearecapturedcoherently. Weprovethatourtransformdoesnotcreateanyartifactsorstreakingthat arenotalreadypresentinthelocalphase. Recallthat(x ,ξ )∈WF(f)(thewavefront-set,[15])iff hasasingularity 0 0 atx indirectionξ . AndforW :R3 →CdefinesetofdirectiononthesphereselectedbyW 0 0 conesupp(W):={ξ/|ξ|∈S2 :ξ ∈supp(W)\{0}} anddefinethesetoffrequenciesnearthemagiccone Γ :={ξ ∈R3 :dist(ξ,Γ )≤ε/2} ε 0 Proposition1(NoArtifactsCreation). TheDipole-lettransformdoesnotintroduceoramplifyanyartifact. Each dipole-letcoefficientD :L2(R3)→L2(R3)isboundedand j,m WF(D f)⊆{(x,ξ)∈WF(f):ξ/|ξ|∈conesupp(W(j))} j,m j,m Proof. AsW(j) issmoothwithpolynomialboundedderivatives,D isapseudodifferentialoperatoroforderzero. j,m j, Moreover∥D f∥ ≤∥W(j)∥ ∥f∥ ≤∥f∥ . Definethespatialcutoffχ∈C∞(R3)andχ(x )=1. j,m L2 j,m L∞ L2 L2 0 0 Fix(x ,ξ )withξ /|ξ | ∈/ conesupp(W(j)). LetV aconicneighborhoodofξ /|ξ |andletϕ ∈ C∞(R3\{0}) 0 0 0 0 j,m 0 0 0 beasmoothcut-offfunctionsuchthatsupp(ϕ) = V andV ∩supp(W(j)). ThenW(j)ϕ ≡ 0andbydefiningthe j,m j,m multiplierM ϕ :=F−1ϕf(cid:98)itcommuteswiththeDipole-let,sowegetthat D j,mM ϕf =M ϕD j,mf =F−1((W j( ,j m)ϕ)f(cid:98))=0 We then notice that when we multiply by the cutoff χM D f = 0 ∈ S(R3). This implies that (x ,ξ ) ∈/ ϕ j,m 0 0 WF(D f). As(x ,ξ )wasarbitraryoutsideoftheconicsupport,wegettheresult. j,m 0 0 4 --- Page 5 --- Dipole-letsforMRPhaseandQSM APREPRINT This highlights an important property: the Dipole-let decomposes without distorting and represent the geometric properties of the magic cone by indexing the windows by the neighborhood of the magic cone Γ : the near-cone 0 windows(m = 0)W (ξ)concentrateswhere|D(ξ)| ≤ δ ,sothefrequenciesnearthemagicconeareisolatedin j,0 0 D f,andcombinedwiththefactthatthecoefficientsaresmoothwith∥D ∥ ≤∥f∥ ,theDipole-letlocalize j,0 j,m L2 L2 anddonotamplifyartifacts,thusthisleadstohaveband-wisecontroltodeployregularizationmethods. Formally: Remark1. Fixascalej. DefinefarconewindowsW (forwhich|D|≥δforlargeδ)andnearwindowW its far near complement. Decomposingψ =ψ +ψ ,weseethat 0 ∗ WF(ψ )∩(R3×Γ )=∅, WF(ψ )⊂(R3×Γ ) 0 ε ∗ ε Thusonthenear-conewindowD ψ =D ψ andD ψ =D ψ . Sodipole-letclearlyseparatesdipolar Wfar Wfar 0 Wnear Wnear ∗ andnon-dipolarcontentofasignalatagivenscale. 2.2 ComputationalExperiments 2.3 AnalysisofPhases Onthe2016QSMChallenge(RC1)[16],weforward-simulatephasefromχ viathedipolemodelandviathefull 33 STI[17]forwardmodelforz-axisacquisition(addingχ ,χ ). Weinjectlocalizedoffsets(single-voxel/spherical)to 13 23 probeunwrap-likeeffects,addcomplexGaussiannoise(SNR=100),andanalyzethein-vivolocalfield. Allvolumes aredecomposedwitha4×3radial-angulargridofD bandstoinspectstructures. j,m 2.4 Dipole-letsasweights Wetestourmethodstocreateadatafidelityforaregularizemethod. Wecancreateadatafidelityweightby (cid:88) E(ψ)(x):= D ψ(x) j,m j,m∈S whereS issomenear-coneselectedbandsandweconstructaweightW byinvertingandrescalingE. Aftervectorization,wesolveaADMMweightedlinearTVsolveravailableattheFANSI-toolbox[6] argmin(cid:13) (cid:13)W(F−1DFχ−ψ(cid:13) (cid:13)2 2+λ∥∇χ∥ 1 (1) χ 2.5 Dipole-letsasRegularizer Streaksstemsfromamplificationofcoefficientsnearthemagiccone,butnoiseandthenon-dipolarcontentofthephase canalsobeamplifieditsimmediatevicinity. WecanuseDipole-letsasaregularizer: wecanselectednear-conebands andpenalizetheircoefficientsviaℓ regularizationandtherestrictionontotheℓ ball: 2 ∞ argmin(cid:13) (cid:13)W(eiF−1DFχ−eiψ(cid:13) (cid:13)2 +(cid:88)α j,m∥D χ∥2+I (D χ) (2) χ (cid:13) (cid:13) 2 2 j,m 2 ∥·∥∞≤βj,m j,m j,m whereI istheconvexindicatorofthesetC [18]. Theℓ termsdampsband-specificenergyandtherestrictionontothe C 2 ℓ clipsstreakingbyβ ineachband. Wesolvethiswithagradient-descentandprojection,similartoNDI[19], ∞ j,m yieldingeffectivestreakattenuationwhilepreservinganatomicaldetails. 3 ResultsandDiscussion WeseeinFigure1theDipole-letofaforward-simulatedfromχ dataofthe2016QSMChallenge(RC1)[16]andwe 33 seethewindowsoftheDipole-letdecomposition. InFigure2weanalyzethefullSTI[17]forwardmodelforz-axis acquisition(addingχ ,χ ). 13 23 InFigure3weseethereconstructionsolvingEquation(1)onnoisyRC1χ simulationwithphasejumpsandthe2019 33 QSMReconstructionChallenge(RC2)[20]Sim2SNR1frequencymap. WeevaluateRMSE,XSIM[21],andvisual streaking. WetestedEquation(2)withtheRC2datasetinFigure4andFigure5. Cleanandcorruptedphasesforwardcalculatedfromχ areshowninFigure2alongwiththeSTIsimulation,and 33 in-vivodata. Thein-vivo–STIdifferenceandnear-conelayersexposenon-dipolarcontent. Near-conelayersfromthe STIsimulationshowthequadrupolarcomponentsderivedfromχ andχ . Figure3showhowinpaintingunrealiable 13 23 voxelsidentifiedandmaskedbydipole-letenergysuppressesstreaking. Tailoring Dipole-lets to attenuate streaking artifacts improves RMSE over NDI and the visual appealing of the reconstructions(Figure4andFigure5),butcanalsoleadtotissueattenuationasshownherewiththelargestvein. 5 --- Page 6 --- Dipole-letsforMRPhaseandQSM APREPRINT Figure1: Dipole-letdecompositionofforwardsimulatedχ phasewith3radialscalesand3angularbandsandtheir 633 correspondingwindows --- Page 7 --- Dipole-letsforMRPhaseandQSM APREPRINT Figure2: Dipole-letdecompositionwith3angularscalesand4radialscales. Top: χ forwardsimulation;STIforwad 33 simulationinz-axis;invivolocalphase. Bottom: χ phasewithaddedphasejumps;χ withcomplexnoise(SNR 33 33 =100);in-vivoresidualfromSTI.Thedetailscalesnearthemagiccone(A,G,M,S),showsthelocalizedno-dipolar componentoftheimageandshowveryclosetozeroanatomicaldetail(dipolarcontent). Farfromtheconeacross scales,weseeasmooth-outversionofbothnon-dipolarcontentandanatomicaldetail. STIshowstensorcross-terms (quadrupolarcontent). InvivofollowsSTIandshownon-dipolarresidual. Noiseisspreadacrossallbands 7 --- Page 8 --- Dipole-letsforMRPhaseandQSM APREPRINT Figure3: Dipole-letdecompositionoftheRC2Sim2SNR1localphase(4angularand4radialbands);cone-adjacent bandsconcentrateunreliablecontentduetodephasingbysubsampling. Middle: baselineQSMfrom(left)RC1χ 33 withphaseerrorsand(right)RC2Sim2SNR1(ROI-maskedonly). Nextrow: Dipole-let–derivedweights(grayscale, sum-of-squaresofselectednear-conebands)andcorrespondingbinarymask(black=threshold). Bottomrows: weighted reconstructionsreducestreakingandmodestlyimproveRMSE/XSIM. 8 --- Page 9 --- Dipole-letsforMRPhaseandQSM APREPRINT Figure 4: Dipole-lets detail bands for the ground truth susceptibility, NDI reconstruction (non-regularized), and reconstructionsregularizedwiththeℓ orℓ normsofthesame3×3dipole-letsbands. Weightsfollowedadyadic 2 ∞ sequence.Dipole-letsefficientlyremovedsmallscalestreaking,butalsoattenuatedveinsalignedwiththecorresponding cone-angulationofthebands. 4 Conclusions Dipole-lets separate dipolar content and non-dipolar content by analyzing its cone proximity across scales, thus providingaphysicallyinterpretableanalysisofphasecomponents. Thisseparationrevealsin-vivoresidualsbeyond dipole/STI models. Using dipole-let energy as a weight offers an effective way to segment streaking sources and improvereconstructionquality. Asasimpleregularizer,separatingstreakingartifactsfromrealstructuresalignedin the same directions as Dipole-let’s cone apertures is non-trivial and more refined strategies are needed. These are simpleapplicationsthathighlightthepotentialofthisframework. Futureresearchincludefurtheranalysisofdipole-let regularizers,analysisofthemathematicalpropertiesofsingularitylocalizationandsuppressionofartifacts,theuse of Dipole-lets for deep learning framework, quality/error metric based on near-cone content, and analysis tool for anisotropy/microstructure. 5 Acknowledgments WethankANIDFONDECYTdeIniciacion11240279andFondecyt1231535. References [1] QSMConsensusOrganizationCommittee,BerkinBilgic,MauroCostagli,Kwok-ShingChan,JeffDuyn,Christian Langkammer, Jongho Lee, Xu Li, Chunlei Liu, José P Marques, et al. Recommended implementation of quantitativesusceptibilitymappingforclinicalresearchinthebrain: aconsensusoftheismrmelectro-magnetic tissuepropertiesstudygroup. Magneticresonanceinmedicine,91(5):1834–1862,2024. 9 --- Page 10 --- Dipole-letsforMRPhaseandQSM APREPRINT Figure5: Dipole-letsregularizationviaℓ andℓ improvesQSMreconstructionsovertraditionalTikhonovregu- 2 ∞ larizationinagradientdescentsolver. Thisproof-of-conceptrevealsthepotentialofDipole-letsformorecomplex regularizationschemes.Interestingly,ℓ Dipole-letsregularizationdoesn’tattenuatefrequencycomponents,asopposed ∞ toℓ regularization(rightcolumn,Fouriertransformofthereconstructions,sagittalplane). 2 10 --- Page 11 --- Dipole-letsforMRPhaseandQSM APREPRINT [2] Jae Kyu Choi, Hyoung Suk Park, Shuai Wang, Yi Wang, and Jin Keun Seo. Inverse problem in quantitative susceptibilitymapping. SIAMJournalonImagingSciences,7(3):1669–1689,2014. [3] SamWharton,AndreasSchäfer,andRichardBowtell. Susceptibilitymappinginthehumanbrainusingthreshold- basedk-spacedivision. Magneticresonanceinmedicine,63(5):1292–1304,2010. [4] LiangdongZhou,JaeKyuChoi,YoungwookKee,YiWang,andJinKeunSeo. Dipoleincompatibilityrelated artifactsinquantitativesusceptibilitymapping. arXivpreprintarXiv:1701.05457,2017. [5] BenjaminPalacios,GuntherUhlmann,andYiranWang. Reducingstreakingartifactsinquantitativesusceptibility mapping. SIAMJournalonImagingSciences,10(4):1921–1934,2017. [6] CarlosMilovic,BerkinBilgic,BoZhao,JulioAcosta-Cabronero,andCristianTejos. Fastnonlinearsusceptibility inversionwithvariationalregularization. Magneticresonanceinmedicine,80(2):814–821,2018. [7] PatrickFuchsandKarinShmueli. Incompletespectrumqsmusingsupportinformation. FrontiersinNeuroscience, 17:1130524,2023. [8] Hyun-Seo Ahn, Sung-Hong Park, and Jong Chul Ye. Quantitative susceptibility map reconstruction using annihilatingfilter-basedlow-rankhankelmatrixapproach. MagneticResonanceinMedicine,83(3):858–871, 2020. [9] ShuaiHuang,JamesJLah,JasonWAllen,andDeqiangQiu. Robustquantitativesusceptibilitymappingvia approximatemessagepassingwithparameterestimation. Magneticresonanceinmedicine,90(4):1414–1430, 2023. [10] Jean-LucStarck,JalalFadili,andFionnMurtagh. Theundecimatedwaveletdecompositionanditsreconstruction. IEEEtransactionsonimageprocessing,16(2):297–309,2007. [11] Jean-LucStarck,FionnMurtagh,andJalalMFadili. Sparseimageandsignalprocessing: wavelets,curvelets, morphologicaldiversity. Cambridgeuniversitypress,2010. [12] JanisStiegelerandSinaStraub. Shearlet-basedsusceptibilitymapreconstructionwithiterativereweightingand nonlineardatafitting. InISMRM&SMRTVirtualConference&Exhibition,pages08–14,2020. [13] DemetrioLabate,Wang-QLim,GittaKutyniok,andGuidoWeiss. Sparsemultidimensionalrepresentationusing shearlets. InWaveletsXI,volume5914,pages254–262.SPIE,2005. [14] LoukasGrafakosetal. Classicalfourieranalysis,volume2. Springer,2008. [15] LarsHörmander. TheanalysisoflinearpartialdifferentialoperatorsIII:Pseudo-differentialoperators. Springer Science&BusinessMedia,2007. [16] ChristianLangkammer,FerdinandSchweser,KarinShmueli,ChristianKames,XuLi,LiGuo,CarlosMilovic, JinsuhKim,HongjiangWei,KristianBredies,etal. Quantitativesusceptibilitymapping: reportfromthe2016 reconstructionchallenge. Magneticresonanceinmedicine,79(3):1661–1673,2018. [17] Chunlei Liu. Susceptibility tensor imaging. Magnetic Resonance in Medicine: An Official Journal of the InternationalSocietyforMagneticResonanceinMedicine,63(6):1471–1477,2010. [18] AmirBeck. First-ordermethodsinoptimization. SIAM,2017. [19] DanielPolak,ItthiChatnuntawech,JaeyeonYoon,SiddharthSrinivasanIyer,CarlosMilovic,JonghoLee,Peter Bachert,ElfarAdalsteinsson,KawinSetsompop,andBerkinBilgic. Nonlineardipoleinversion(ndi)enables robustquantitativesusceptibilitymapping(qsm). NMRinBiomedicine,33(12):e4271,2020. [20] QSMChallenge2.0OrganizationCommittee, BerkinBilgic, ChristianLangkammer, JoséPMarques, Jakob Meineke,CarlosMilovic,andFerdinandSchweser. Qsmreconstructionchallenge2.0: designandreportofresults. MagneticResonanceinMedicine,86(3):1241–1255,2021. [21] CarlosMilovic,CristianTejos,JavierSilva,KarinShmueli,andPabloIrarrazaval. Xsim: Astructuralsimilarity indexmeasureoptimizedformriqsm. Magneticresonanceinmedicine,93(1):411–421,2025. 11