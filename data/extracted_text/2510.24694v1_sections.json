{
  "abstract": "Abstract LLM-basedsearchagentsareincreasinglytrainedonentity-centricsynthetic datatosolvecomplex,knowledge-intensivetasks. However,prevailingtrain- ing",
  "methods": "methods is an entity-centric approach to complexity generation (Gao et al., 2025; Wu et al., 2025b;a; 10 --- Page 11 --- Li et al., 2025b;a; Tao et al., 2025; Wu et al., 2025c). During data synthesis, a rich set of ground-truth entitiesthatformthefactualbackboneofthecorrectansweraresystematicallydiscarded. Priorworkhas exclusivelyusedthefinalquestion-answerpairsfromthisprocessforpost-training(Dongetal.,2025; Wuetal.,2025a;Lietal.,2025b). Incontrast,ourworkisthefirst,toourknowledge,torecognizethese discardedentitiesnotasabyproduct,butasanuntappedsourceoffine-grained,factualsupervision. Wepioneertheideaofrepurposingthis\u201cwaste\u201dmaterialtoformulateanentity-awarerewardfunction, therebybridgingthegapbetweenthedatagenerationprocessandtheRLalignmentphaseinanoveland efficientmanner. Reinforcement Learning for Search Agents. Group Relative Policy Optimization (GRPO) and its variants(Shaoetal.,2024;Yuetal.,2025;Xuetal.,2024;Zhaoetal.,2025;Hu,2025;Xueetal.,2025;Su etal.,2025)havebecomeadominantparadigmforaligningsearchagents. Notableadvancementswithin thisparadigm,suchasARPO(Dongetal.,2025),haveadaptedtheframeworkwithanentropy-based rolloutmechanismforcomplexmulti-turnwebsearchsettings. Despitetheserefinements,theentire familyofGRPO-likemethodsisfundamentallyconstrainedbyitsrelianceonasparse,outcome-based rewardsignal. Whileconventionalsolutionstosuchsparsity,likeProcessRewardModels(PRMs)(Fan et al., 2025; Anonymous, 2025; Zhang et al., 2025b) or tree-based sampling (Yang et al., 2025; Hou etal.,2025),existinrelateddomains,theyareill-suitedforopen-endedwebsearchduetoprohibitive annotationcostsandcomputationalintractability. Ourwork,E-GRPO,divergesfromtheseapproachesby proposingarewardsignalthatisbothfine-grainedandcomputationallyefficient,requiringnoadditional annotation,modeltraining,orcomplexsampling. 6",
  "introduction": "1 Introduction The advent of Large Language Models (LLMs) has catalyzed the development of sophisticated au- tonomousagents,withsearchagentsemergingasaprominentclassforsolvingcomplex,knowledge- intensive tasks (Yao et al., 2023; Wang et al., 2024; Xi et al., 2025). Training these agents to navigate thevast,noisywebeffectivelyrequiresabundantandchallengingdata(GoogleTeam,2025;OpenAI, 2025;xAITeam,2025;MoonshotAI, 2025). To meetthisdemand, a dominantparadigmofsynthetic datagenerationhasemerged(Wuetal.,2025b;Lietal.,2025b;Gaoetal.,2025). Inthisparadigm,as shown in Figure 1 (left), complex questions are often created by systematically transforming simple \"seed\"questionsthroughoperationslikefactinjectionordeliberateobfuscation. Thisprocesscreatesan intricateproblemstructure,pavedwithkeyentitiesthatformthefactualbackboneofthecorrectanswer. Thissyntheticdataisthenusedtotrainagentswithinthenow-dominantreinforcementlearning(Wen (cid:0) Correspondingauthors.{zlw439616,   1 5202 tcO 82 ]LC.sc[ 1v49642.0152:viXra --- Page 2 --- etal.,2024;Singhetal.,2025),especiallywithGroupRelativePolicyOptimization(GRPO)(Shaoetal., 2024)anditsnumerousvariants(Yuetal.,2025;Dongetal.,2025;Hu,2025;Xuetal.,2024;Zhaoetal., 2025). Thesemethodstypicallyrelyonoutcome-basedrewards,utilizingonlythefinalanswerwhile discarding the intermediate entity information meticulously embedded during data synthesis. This mechanismleadstotherewardsparsityproblem(Qianetal.,2025;Dengetal.,2025),whichmanifests criticallyforsearchagents(Songetal.,2025;Wuetal.,2025a;Jinetal.,2025;Lietal.,2025c;Zhengetal., 2025;Zhangetal.,2025a;Lietal.,2025b;Gaoetal.,2025): bytreatingallnegativesamplesuniformly, GRPO fails to distinguish a \"near-miss\"\u2014a response with correct intermediate reasoning steps but a flawedanswer\u2014fromacompletefailure. Forinstance,inansweringWhowasthedirectorofthe1997film starringtheactorwhowontheAcademyAwardforBestActorforthefilm\u2019TheRevenant\u2019?,a\"near-miss\"that correctly identifies the actor (Leonardo) and the film (Titanic) but fails on the final answer is far more informativethanonethatmisunderstandsthequeryentirely. Bypenalizingbothequally,standardGRPO discardscruciallearningsignalsembeddedinpartiallycorrectreasoning,forcingthemodeltore-learn stepsithadalreadymastered. Onenaturalapproachtoaddressthissparserewardproblemistoincorporatefine-grained,process-level supervision. In domains such as mathematics and code, this is achieved either by evaluating each intermediatestepwithaProcessRewardModel(PRM)(Fanetal.,2025;Anonymous,2025;Zhangetal., 2025b) or by employing complex sampling mechanisms (e.g., tree-based search) to derive step-level advantages(Yangetal.,2025;Houetal.,2025). However,thesemethodsareill-suitedfortheopen-ended natureofwebsearch. Thesheerscaleanddynamicnatureofwebcontentrendertheannotationrequired for a PRM prohibitively expensive. Similarly, the extensive length of search agent trajectories, often involvingdozensoftoolcallsandreasoningsteps,makesintricatesamplingstrategiescomputationally intractable. Thisleavesacriticalgap: howcanweobtainafine-grained,informative,yetcomputationallyefficient reward signal for search agents? The answer, we find, lies hidden in plain sight: within the very entity-centric information from synthetic data generation that GRPO-like",
  "experiments": "Experiment Setup Benchmarks. Our evaluation spans a diverse set of 11 benchmarks to comprehensively assess E- GRPO\u2019seffectiveness. Forquestion-answeringtasks,weusethreesingle-hopdatasets: NaturalQuestions (NQ)(Kwiatkowskietal.,2019),TriviaQA(TQ)(Joshietal.,2017),andPopQA(Mallenetal.,2022);and fourmulti-hopdatasets: 2WikiMultiHopQA(2Wiki.)(Hoetal.,2020),HotpotQA(HQA)(Yangetal., 2018),Bamboogle(Bamb.)(Pressetal.,2022),andMuSiQue(Musi.)(Trivedietal.,2022). Wefurthertest ouragentonfourchallengingdeepresearchbenchmarks: GAIA(Mialonetal.,2023),BrowseComp(Wei etal.,2025),BrowseComp-ZH(Zhouetal.,2025),andxbench-DeepSearch(xbench-DS)(Xbench-Team, 2025). FollowingAsearcher(Gaoetal.,2025),weuse1000sampledinstancesfromthevalidationsetsof HQA,2Wiki.,andMusi. ForGAIA,weusethe103-sampletext-onlyvalidationsubset(Lietal.,2025c). Forallotherbenchmarks,weusetheirfulltestsets. Baselines. OurprimarybaselineisthedirectcounterparttrainedwithGRPO(Shaoetal.,2024),allowing foracontrolledcomparisonofthealgorithmicenhancement. WealsocompareagainstasuiteofReAct- basedagents. ForQAbenchmarks, thisincludesR1-Searcher-7B(Songetal.,2025), DeepResearcher- 7B(Zhengetal.,2025),Search-R1-32B(Jinetal.,2025),Simple-DS-QwQ(Sunetal.,2025),andASearcher- 14B (Gao et al., 2025). For deep research benchmarks, we include advanced models like OpenAI-o3, Claude-4-Sonnet(Anthropic,2025),Kimi-K2(Teametal.,2025),andDeepSeek-V3.1(Liuetal.,2024), alongsideopen-sourcemodelswithnomorethan32BparameterssuchasR1-Searcher-7B,WebThinker- RL(Lietal.,2025d),WebDancer-QwQ(Wuetal.,2025a),andWebSailor-7B/32B(Lietal.,2025b). EnvironmentSettings. WeconducttrainingintwodistinctenvironmentstovalidateE-GRPO\u2019sro- bustness: a closed-world local knowledge base (Local) and an open-world web exploration (Web) environment. IntheLocalsetting,searchandvisittoolsaresimulatedviainformationretrievalovera Wikipedia2024corpus(Karpukhinetal.,2020;Gaoetal.,2025). IntheWebsetting,theagentinteracts withthelivewebusingGoogleSearchandJina(Jina.ai,2025)forpagefetching. TrainingDetails. OurexperimentsarebasedonQwen2.5-7B-Instruct(Yangetal.,2024)andQwen3- 30B-A3B-Instruct-2507(Team,2025a),coveringdifferentmodelsizesandarchitectures(denseandMoE). ItisimportanttonotethatourstudyaimstovalidatetheeffectivenessofE-GRPOatthealgorithmic level,notmerelytopursuestate-of-the-artperformance.Therefore,weuselimiteddatatoensuretraining efficiencywhilestillenablingperformancecomparison. \u2022 Cold-startSFT:Wefirstfine-tunethebasemodelson11KsamplesfromSailorFog-QA(Lietal.,2025b). Thisstep,followingDongetal.(2025),mitigatesrewardcollapseandensuresthemodelunderstands theagenticformatbeforeRL. \u2022 RL: We generate two distinct 1k-sample datasets for RL training. For the Local environment, we synthesizedatausingtheAsearcher(Gaoetal.,2025)methodoverthe2024Wikipediacorpus. For theWebenvironment,weusetheSailorFog-QAdatagenerationpipeline. Crucially,forbothdatasets, weretainallground-truthentitiesgeneratedduringthesynthesisprocesstoenableE-GRPO.Wetrain the7Bmodelinbothenvironments,whilethe30BmodelistrainedonlyinthemorecomplexWeb environment. Foreachsetup,weapplybothGRPOandE-GRPO. We denote our models by their training environment, model sizes, and the training algorithm, e.g., Local-7B-GRPO.DetailedhyperparametersarepresentedinAppendixC. EvaluationMetrics. Modelanswers,extractedfromthemodeloutputenclosedin<answer>and</ answer>tags(detailedinAppendixA),areevaluatedforcorrectnessusingQwen2.5-72B-Instructunder 7 --- Page 8 --- Table1:  Resultswith\u2021aresourcedfromGao etal.(2025). Thetopscoresofeachevaluationenvironmentarebolded. Multi-HopQA Single-HopQA Environment Model Avg 2Wiki. HQA Bamb. Musi. NQ TQ PopQA ComparisonamongOurModels Local-7B-SFT 74.0 66.7 72.8 30.2 49.8 78.4 49.6 60.2 Local Local-7B-GRPO 75.1 65.1 74.4 31.2 51.5 82.0 50.4 61.4 Local-7B-E-GRPO 79.6 69.0 78.4 32.8 55.8 83.9 50.2 64.2 ComparisonwithOtherBaselines R1-Searcher-7B\u2021 69.4 61.6 72.0 25.3 48.7 79.5 45.2 57.4 DeepResearcher-7B\u2021 64.1 61.0 76.8 24.5 52.9 82.8 45.7 58.3 Search-R1-32B\u2021 69.3 64.2 81.6 30.8 51.1 86.6 53.6 62.5 Simple-DS-QwQ\u2021 80.4 67.5 83.2 32.9 55.3 90.2 47.8 65.3 Web ASearcher-14B\u2021 79.8 70.5 80.8 33.8 55.4 88.5 50.5 65.6 Local-7B-SFT 76.8 70.7 80.2 32.2 55.4 88.7 48.9 64.7 Local-7B-GRPO 77.2 73.8 82.4 34.9 55.9 89.3 50.1 66.2 Local-7B-E-GRPO 80.4 73.7 85.6 34.9 59.1 90.4 50.2 67.8 theLLM-as-Judgesetting.  acrossthreerollouts. 4.2 Main",
  "results": "results strongly suggest that Karl Weyprecht is the central figure in question, with multiple sources mentioning his leadership of the 1872\u201374 polar expedition aboard the Tegetthoff and his later scientific initiatives. However, to fully confirm his identity and gather all the necessary details\u2014such as the ship\u2019s name, the Austrian admiral it was named after, his role in proposing the InternationalPolarYear, and whether he received the RoyalGeographicalSociety\u2019sFounder\u2019sMedal\u2014I need a comprehensive, authoritative sum- mary. VisitingtheWikipediapagededicatedtoKarlWeyprechtshouldprovideaconsolidated accountofhisachievements,honors,andscientificcontributions. Ineedtovisitthispagenowto extractthesespecificdetailsanddefinitivelyanswerthequestion. </think> <tool_call> {\"name\": \"visit\",\"arguments\": {\"url\": [\"\"],\"goal\": \"Extractdetails: vesselname,theAustrianadmiral,internationalscientificinitiative,Founder\u2019s MedalofRoyalGeographicalSociety\"}} </tool_call> <tool_response> Theusefulinformationin details: vesselname,theAustrianadmiral,internationalscientificinitiative,Founder\u2019sMedalof RoyalGeographicalSocietyasfollows: Evidence in page: He co-led, with Julius von Payer, the 1872-1874 [[Austro-Hungarian North PoleExpedition]]whichdiscoveredthearchipelago[[FranzJosefLand]]intheArcticOcean. The expedition\u2019sship\u201cAdmiralTegetthoff\u201d... </tool_response> Round5 <think> To arrive at the answer \"Karl Weyprecht,\" I pieced together several key clues from the ques- tionandverifiedthemthroughtargetedsearchesandauthoritativesources. First,Iconfirmed thatWeyprechtledalate19th-centurypolarexpeditionaboardtheship\"AdmiralTegetthoff,\" whichwasnamedafterAustrianAdmiralWilhelmvonTegetthoff\u2014thisdirectlymatchedthe ship and admiral mentioned in the question. Next, I established that Weyprecht was instru- mentalinproposingtheInternationalPolarYear, amajorcollaborativescientificinitiativefor 20 --- Page 21 --- the polar regions. Finally, I verified through multiple sources that he was awarded the 1875 RoyalGeographicalSociety\u2019sFounder\u2019sMedal,oneofthehighesthonorsinBritishgeography. Theconvergenceofthesefacts\u2014leadershipoftheTegetthoffexpedition,advocacyfortheInterna- tionalPolarYear,andreceiptoftheRGSFounder\u2019sMedal\u2014confirmsthatKarlWeyprechtisthe explorerdescribed. </think> <answer> KarlWeyprecht exemplifies the characteristics in your query: as commander of a significant polarexpedition(aboardtheship\"AdmiralTegetthoff\")afteraprominentAustrianadmiral,asa proposaltargetofamajorinternationalscientificinitiative(theInternationalPolarYear),andas arecipientofoneofthemostdistinguishedhonorsfromamajorBritishgeographicalsociety(the RoyalGeographicalSociety\u2019sFounder\u2019sMedal). </answer>\u2713 CaseTrajectoryonSailorFog-QA:FailedbyWeb-30B-GRPO Question: A European naval officer, known for leading a significant polar expedition in the late 19th century aboard a vessel named after an Austrian admiral, later proposed a major internationalscientificinitiativefocusedonthepolarregions. Forhiscontributionstoexploration, he received one of the highest honors from a major British geographical society. Who is this explorer? Ground-truth Entities: [Tegetthoff, International Polar Year, Royal Geographical Society\u2019s Founder\u2019sMedal] Answer: KarlWeyprecht Round1 <think> ThequestioninvolvesaEuropeannavalofficerwholedasignificantpolarexpeditioninthelate 19thcentury,hadavesselnamedafteranAustrianadmiral,laterproposedamajorinternational scientificinitiativeforthepolarregions,andwashonoredbyaprominentBritishgeographical society. Topinpointtheindividual,Ineedtoconnectthedotsbetweentheexpedition,thevessel\u2019s name, the Austrian admiral",
  "related_work": "Related Work SearchAgents. ThecapabilitiesofLargeLanguageModels(LLMs)havefueledasurgeinresearchon autonomousagentsthatcaninteractwithexternalenvironmentstosolvecomplextasks. Afoundational paradigminthisareaistheReActframework(Yaoetal.,2023),whichinterleavesreasoning(thought) andactionsteps. Buildingonthis,aprominentlineofresearchhasfocusedonsearchagentsdesignedto navigatetheweb(Songetal.,2025;Zhengetal.,2025;Lietal.,2025c;Zhangetal.,2025a;Sunetal.,2025). AdvancedmodelslikeGeminiDeepResearch(GoogleTeam,2025),OpenAIDeepResearch(OpenAI, 2025),GrokDeepSearch(xAITeam,2025),alongwithsmalleropen-sourcemodelssuchasAsearcher(Gao etal.,2025),WebThinker(Lietal.,2025d),WebWalker(Wuetal.,2025b),WebDancer(Wuetal.,2025a), andWebSailor(Lietal.,2025b;a)havedemonstratedincreasingproficiencyinretrievingandsynthesizing informationfromnoisy,real-worldwebsources. Ourworkdirectlycontributestoimprovingthetraining methodologyforthisclassofagents,addressingthechallengeoflearningrobustpoliciesincomplexweb environments. SyntheticDataGenerationforSearchAgents. Thenow-dominantparadigmfortrainingsearchagents relies heavily on high-quality synthetic data (Team, 2025b). A common thread in these generation",
  "conclusion": "Conclusion Inconclusion,weproposeEntity-awareGroupRelativePolicyOptimization(E-GRPO),anovelframe- workdesignedtoenhancepolicyoptimizationforsearchagents. Ouranalysisrevealsthattheground- truthentitiesdiscardedduringsyntheticdatagenerationserveasapowerfulproxyforfactualcorrectness, offeringafine-grainedrewardsignalthatstandardmethodsignore. E-GRPOleveragesthisinsightby formulatinganentity-awarerewardfunction,assigningpartialcredittonegativesamplesbasedontheir entitymatchratetoencouragemeaningfulexploration. AcrossawidearrayofQAanddeepresearch benchmarks,E-GRPOconsistentlyandsignificantlyoutperformstheGRPObaseline. Remarkably,itnot onlyachievessuperioraccuracybutalsolearnsmoreefficientpolicieswithfewertoolcalls,offeringa moreeffectiveandsample-efficientsolutionforaligningsearchagentsincomplex,knowledge-intensive tasks. 11 --- Page 12 ---",
  "references": "references to British geographical society honors\u2014such as the RoyalGeographicalSociety\u2019sFounder\u2019sMedalorPatron\u2019sMedal\u2014andclarifyhisroleinshap- ing international polar scientific collaboration. I need to visit this page now to gather these definitivedetails. </think> <tool_call> {\"name\": \"visit\",\"arguments\": {\"url\": [\"\"],\"goal\": \"ExtractawardsofJuliusvonPayer,particularlyanyfromBritishGeographicalSociety,andclarify hisroleinshapinginternationalpolarscientificcollaboration\"}} </tool_call> <tool_response> Theusefulinformationin awardsofJuliusvonPayer,particularlyanyfromBritishGeographicalSociety,andclarifyhisrole inshapinginternationalpolarscientificcollaborationasfollows: ... </tool_response> Round5 <think> Todeterminewhichexpeditionleader\u2014JuliusvonPayerorKarlWeyprecht\u2014receivedtheRoyal GeographicalSociety\u2019shighesthonors,IneedtoclarifywhetherPayerwasactuallyawardedthe goldmedalorthePatron\u2019sMedal,andinwhichyear. ThesummaryonthemainJuliusvonPayer page referenced the Patron\u2019s Medal in 1971, but individual award listings on the Gold Medal (RGS)Wikipediapageshouldprovideadefinitive, year-by-yearrosterofrecipients, ensuring accuracy regarding both the medal and its recipients. By visiting this page, I can confirm the exactyearandwhetherJuliusvonPayerisindeedlistedamongthehonorees,whichiscrucialfor answeringthequestionabouthisrecognitionbytheBritishgeographicalsociety. Ineedtocheck thisofficiallistnowtoconfirmthedetails. </think> 23 --- Page 24 --- <tool_call> {\"name\": \"visit\", \"arguments\": {\"url\": [\"\"], \"goal\": \"Check if Julius von Payer is listed as a recipient of the Royal Geographical Society\u2019s highesthonorandyear\"}} </tool_call> <tool_response> Theusefulinformationin ifJuliusvonPayerislistedasarecipientoftheRoyalGeographicalSociety\u2019shighesthonorand yearasfollows: Evidenceinpage: 1875|[[JuliusPayer]]|ForexplorationsanddiscoveriesintheArcticregions... </tool_response> Round6 <think> Toarriveattheanswer,IfirstnoticedthatthequestiondescribedaEuropeannavalofficerwho ledasignificantpolarexpeditioninthelate19thcenturyaboardavesselnamedafteranAustrian admiral,laterproposedamajorinternationalscientificinitiative,andreceivedatophonorfroma Britishgeographicalsociety. MyinitialsearchesconfirmedthattheAustro-HungarianNorthPole expedition(1872\u20131874),ledbyJuliusvonPayerandCarlWeyprecht,usedtheshipTegetthoff, namedafterAdmiralWilhelmvonTegetthoff. Furtherinvestigationrevealedthatwhileboth menwerekeyfigures,itwasJuliusvonPayerwhowasawardedtheRoyalGeographicalSociety\u2019s Patron\u2019s Medal (the highest British geographical honor) for his achievements. Therefore, by piecingtogethertheexpeditiondetails,thenamingofthevessel,andthespecificrecognitionfrom theRGS,IconcludedthattheexplorerinquestionisJuliusvonPayer. </think> <answer> JuliusvonPayer stands out as the notable European naval officer who fits all aspects of your query,havingledalandmarkpolarexpedition,playedakeyroleinthefoundationofinternational polarscienceinitiatives,andbeenhonoredbytheforemostBritishgeographicalsocietyforhis achievements. </answer>\u2717 24",
  "discussion": "Discussion about Synthetic-data Entities B.1 Entity Construction First,weexplaintheconstructionoftheground-truthentitysetsfortwodifferentdatasynthesismethods usedinourexperiments. ASearcher. AsillustratedinFigure1andSection2.2,thequestionisiterativelyconstructedbyselecting an entity and replacing it with descriptive facts or fuzzing it. Consequently, we use all selected and modifiedentitiesforaquestionasitsground-truthentityset. SailorFog-QA. As shown in Section 2.2, data generation begins by sampling an entity subgraph, followedbypromptinganLLMtogenerateaquestioncenteredaroundtheseentitynodes. Therefore,the nodesetofthesampledsubgraphisregardedastheground-truthentityset. EntityQualityControl. Sincethequestiongenerationprocessensuresquestionquality,e.g.,injected factsstrictlyadheretotheselectedentity,andgeneratedquestionsareconsistentlycenteredaroundthe sampled subgraph, the resulting entity sets are highly precise. Even if there are unexpectedly noisy entities,ourrewardmechanismisrobusttothem. Sinceanyirrelevantentityislikelytobemissedby allrolloutswithinagroup,itdoesnotchangetheirrelativeperformanceandthusdoesnotaffectthe normalizedrewardsignal. B.2 Entity Matching Then,weconsidertwoquestionsrelatedtotheentitymatchingmechanism: (1)Whydoweusetheexact stringmatchratherthanusinganLLMformatching? (2)Whydoweonlycounttheentitiesmatchedin thoughts,excludingthosematchedinobservation? RationaleforExactStringMatching. OurdecisiontouseexactstringmatchinginsteadofanLLM- based judger is primarily motivated by the nature of our ground-truth entities, which are definite, short-formed strings with little ambiguity. This characteristic makes exact matching a natural and 16 --- Page 17 --- 3.5 3.0 2.5 2.0 1.5 1.0 0.5 0.0 0.0 0.2 0.4 0.6 0.8 1.0 Normalized (Thought) Entity Match Rate ytisneD elpmaS Correct Wrong 4.0 3.5 3.0 2.5 2.0 1.5 1.0 0.5 0.0 0.0 0.2 0.4 0.6 0.8 1.0 Normalized (Trajectory) Entity Match Rate ytisneD elpmaS Correct Wrong Figure5: ComparisonofNormalizedentitymatchrateinthoughtsandentiretrajectories. sufficientmethod,whichinturnaddressestwopracticalconcerns: trainingefficiencyandrobustness againstrewardhacking. First,employinganLLMtosemanticallyparseandmatchentitieswithinlongreasoningtraceswould introducesignificantcomputationallatency,impedingthethroughputoftheRLtrainingloop. Incontrast, exactstringmatchingiscomputationallytrivialandaddsnegligibleoverhead. Second,whileadvancedLLMscanperformsemanticmatching,theyarealsomoresusceptibletoexploita- tionbythepolicymodel. Inpreliminaryexperiments,weobservedadistinctreward-hackingbehavior: the agent learned to extend its thoughts with verbose, superficially relevant phrases that, while not containingthecorrectentities,wouldmisleadtheLLMjudgeintoerroneouslyassigningpartialcredit. Exactstringmatching,beinglessflexible,providesamorereliablerewardsignal,ensuringtheagentis rewardedforfactualcorrectnessratherthanplausible-soundingtext. RationaleforThought-OnlyMatching. Tojustifywhywematchentitiesexclusivelywithintheagent\u2019s thoughts(<think> </think>blocks),weanalyzethedifferencebetweenthisapproachandmatching acrosstheentiretrajectory(includingobservations). AsshowninFigure5,thetwomethodsyieldnotablydifferentdistributionsforincorrecttrajectories. Whilethought-basedmatching(left)showsaclearseparationwithmostfailureshavingalowmatchrate, trajectory-basedmatching(right)producessignificantlymore\u201cfalsepositives\u201d: incorrectrolloutsthat stillachieveahighentitymatchrate. Wedoseveralcasestudiesandfindthecauseofthisdiscrepancy. Often,akeyentityispresentinthe observationreturnedbyatool(e.g.,asearchsnippet),buttheagentfailstoextractandincorporatethis informationintoitsreasoningprocess. Rewardingtheagentbasedontheentiretrajectorywouldgrant unearnedcreditformerelyencounteringinformation,notforunderstandingandactinguponit. This createsanoisyrewardsignalthatfailstopenalizeatruereasoningfailure. Therefore,byconfiningentity matching to the agent\u2019s thoughts, we ensure the reward is directly coupled to the model\u2019s ability to identifyandinternalizekeyinformation,providingacleanerandmoretargetedlearningsignal. C Hyperparameters SFT. Weapplyatrainingbatchsizeof32,acosinedecaylearningrateof5e-6forabout4.8epochs,with alinearwarmupstartingfrom1e-10for0.2epochs. 17 --- Page 18 --- RL. Weapplyacontextlengthof32k,atoolcallbudgetof40,atrainingbatchsizeof64,appobatch sizeof64(exactlyonpolicyoptimization),agroupsizeof8,andalearningrateof2e-6forabout5epochs. ForE-GRPO,wesettheentitymatchingweight\u03b1as0.3bydefault. Inference. Weapplyatemperatureof0.6,atop_pof0.95,andatoolcallbudgetof40forinference. D Case Study Toillustratethequalitativedifferencesinreasoning,wepresentacomparativecasestudyusingtrajectories generatedbyWeb-30B-GRPOandWeb-30B-E-GRPOforthesamequery.TheE-GRPOagentdemonstrates amoredirectandefficientreasoningpath,requiringfewertoolcallstosuccessfullyidentifyallkeyentities andculminatinginthecorrectanswer.Instarkcontrast,theGRPOagentembarksonalonger,lessfruitful trajectory. Despiteusingmoretoolcalls,itfailstopinpointthecriticalentityinthethoughts,theFirst InternationalPolarYear(describedasthe\u201cinternationalscientificinitiativefocusedonthepolarregions\u201d), whichultimatelyleadstoanincorrectanswer. CaseTrajectoryonSailorFog-QA:SolvedbyWeb-30B-E-GRPO Question: A European naval officer, known for leading a significant polar expedition in the late 19th century aboard a vessel named after an Austrian admiral, later proposed a major internationalscientificinitiativefocusedonthepolarregions. Forhiscontributionstoexploration, he received one of the highest honors from a major British geographical society. Who is this explorer? Ground-truth Entities: [Tegetthoff, International Polar Year, Royal Geographical Society\u2019s Founder\u2019sMedal] Answer: KarlWeyprecht Round1 <think> Toidentifytheexplorerinquestion,Ineedtoconnectseveralspecificclues: aEuropeannaval officerwholedanotablepolarexpeditioninthelate19thcenturyaboardashipnamedafteran Austrianadmiral, laterproposedamajorinternationalpolarscientificinitiative, andreceived atophonorfromamajorBritishgeographicalsociety. Thesearehighlydistinctivedetails,but the identity is not immediately clear. By structuring my search queries to include all these elements\u2014expeditiontiming,vesselnameorigin,scientificinitiative,andBritishrecognition\u2014I maximizethechanceofsurfacingsourcesthatdirectlylinkthesefactstoasingleindividual. This comprehensiveapproachshouldyieldeithertheexplorer\u2019snameorauthoritativereferencesthat willallowmetodeducetheanswer. Ineedtorunthesetargetedsearchesnowtosynthesizethe relevantinformation. </think> <tool_call> {\"name\": \"search\", \"arguments\": {\"query\": [\"European naval officer polar expedition late 19th century vessel named after Austrian admiral\", \"European naval officer proposed major internationalscientificinitiativepolarregions\",\"Europeannavalofficerreceivedhighesthonors majorBritishgeographicalsociety\",\"late19thcenturyvesselnamedafterAustrianadmiralpolar expedition\"]}} </tool_call> <tool_response> AGooglesearchfor\u2019Europeannavalofficerpolarexpeditionlate19thcenturyvesselnamedafter 18 --- Page 19 --- Austrianadmiral\u2019found10results: ##WebResults1. [Austro-HungarianNorthPoleexpedition-Wikipedia] ( theTegetthoff,namedfortheAustrianAdmiralWilhelmvonTegetthoff,underwhomWeyprecht hadserved. ItwasbuiltforthisexpeditionbyTeklenborg&BeurmanninBremerhaven. Itwasa three-mastedbarkentineof220tons,38.34mlong,witha100horsepower(75kW)steamengine. 2. [WilhelmvonTegetthoff-Wikipedia] ( ... </tool_response> Round2 <think> TheWikipediaarticleontheAustro-HungarianNorthPoleexpeditionislikelytoprovideau- thoritativedetailsabouttheexpedition\u2019sleader, theship\u2019sname, anditsnamesake. Sincethe questionhingesonconnectingtheidentityofthenavalofficer,thevesselnamedafteranAustrian admiral,andsubsequentachievements,reviewingthispageshouldclarifywholedtheexpedition andconfirmthelinkbetweentheshipandAdmiralWilhelmvonTegetthoff. Additionally,the articlemaymentiontheleader\u2019slaterscientificinitiativesandhonors,whicharecrucialforfully answeringthequestion. Ineedtovisitthispagetoextractthesespecificdetailsandestablishthe explorer\u2019sidentity. </think> <tool_call> {\"name\": \"visit\", \"arguments\": {\"url\": [\" Hungarian_North_Pole_expedition\"], \"goal\": \"Identify the commander (led by) and the vessel\u2019snamesakename,AdmiralWilhelmvonTegetthoff\"}} </tool_call> <tool_response> Theusefulinformationin Hungarian_North_Pole_expeditionforusergoalIdentifythecommander(ledby)andthevessel\u2019s namesakename,AdmiralWilhelmvonTegetthoffasfollows: Evidenceinpage: TheAustro-HungarianNorthPoleexpeditionwasanArcticexpeditiontofind theNorth-EastPassagethatranfrom1872to1874undertheleadershipofJuliusvonPayerand KarlWeyprecht. TheexpeditiondiscoveredandpartiallyexploredFranzJosefLand. ... </tool_response> Round3 <think> TodeterminewhetherKarlWeyprechtreceivedoneofthehighesthonorsfromamajorBritish geographicalsociety,Ineedtodirectlyassociatehisnamewithsuchrecognition. Theprevious informationconfirmedhisleadershipoftheexpeditionandthevessel\u2019snamesake,butthequestion also requires evidence of prestigious British honors. By searching for combinations of \"Karl Weyprecht\"withtermslike\"highesthonors\"and\"Britishgeographicalsociety,\"Icanefficiently uncoverwhetherhewasawardedsomethingliketheFounder\u2019sMedalorasimilardistinction from the Royal Geographical Society. This targeted search should clarify if Weyprecht fits all aspects of the question. I need to run these specific queries now to confirm the final piece of information. 19 --- Page 20 --- </think> <tool_call> {\"name\": \"search\",\"arguments\": {\"query\": [\"KarlWeyprechthighesthonorsBritishgeographical society\",\"KarlWeyprechtBritishgeographicalsociety\",\"KarlWeyprechtFounder\u2019sMedal\",\"Karl WeyprechthonorsRoyalGeographicalSociety\"]}} </tool_call> <tool_response> AGooglesearchfor\u2019KarlWeyprechthighesthonorsBritishgeographicalsociety\u2019found10results: ##WebResults1. [KarlWeyprecht-Wikipedia] ( highesthonors ... </tool_response> Round4 <think> The search"
}