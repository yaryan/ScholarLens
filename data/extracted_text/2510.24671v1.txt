--- Page 1 --- Multi-Agent Scenario Generation in Roundabouts with a Transformer-enhanced Conditional Variational Autoencoder Li Li1, Tobias Brinkmann1, Till Temmen1, Markus Eisenbarth1, and Jakob Andert1 Abstract‚ÄîWith the increasing integration of intelligent driv- method is scenario-based testing in virtual environments. ingfunctionsintoserial-producedvehicles,ensuringtheirfunc- In [6] a scenario can be defined as temporal sequence tionality and robustness poses greater challenges. Compared of maneuvers and environmental elements, including traffic to traditional road testing, scenario-based virtual testing offers elements, natural elements, road elements, etc. Scenarios significant advantages in terms of time and cost efficiency, reproducibility, and exploration of edge cases. We propose are systematically designed to emulate real-world driving a Transformer-enhanced Conditional Variational Autoencoder conditions and can be customized with particular emphasis (CVAE-T)modelforgeneratingmulti-agenttrafficscenariosin on the trajectories and interactive behaviors of the traffic roundabouts,whicharecharacterizedbyhighvehicledynamics participants. In addition, scenario-based testing enables the and complex layouts, yet remain relatively underexplored in exploration of rare and safety-critical traffic situations that currentresearch.Theresultsshowthattheproposedmodelcan accuratelyreconstructoriginalscenariosandgeneraterealistic, are difficult to observe in real-world data [7]. diverse synthetic scenarios. Besides, two Key-Performance- The generation of scenarios consisting of single-agent Indicators (KPIs) are employed to evaluate the interactive trajectoryinrelativelysimpleroadlayouts,suchashighways, behavior in the generated scenarios. Analysis of the latent has been extensively studied. However, such approaches are spacerevealspartialdisentanglement,withseverallatentdimen- sions exhibiting distinct and interpretable effects on scenario insufficient for validating functions that involve interactions attributessuchasvehicleentrytiming,exittiming,andvelocity between multiple traffic participants, such as AEB, FCW profiles. The results demonstrate the model‚Äôs capability to gen- or Collision Avoidance (CA). To address this limitation, eratescenariosforthevalidationofintelligentdrivingfunctions traffic simulation involving multiple agents has attracted involving multi-agent interactions, as well as to augment data growing research attention. Nevertheless, these simulations for their development and iterative improvement. often lack sufficient granularity in modeling the detailed I. INTRODUCTION long-term trajectories and interactive behavior among agents Intelligent driving functions are shaping the automotive [8]. Realistic scenario generation that represents the spatio- industry. Functions like Adaptive Cruise Control (ACC) or temporal relationships between multiple agents remains a LaneKeepingAssistance(LKA)cantakethelongitudinalor significant challenge, particularly in complex intersections lateral control or both, thereby reducing driver workload and where high vehicle dynamics and diverse maneuver possi- improvingcomfort.Inordertoenhancethedrivingsafety,ac- bilities introduce substantial behavioral uncertainty. tivesafetysystemshavedemonstratedsignificantpotentialin Roundabouts, as a type of at-grade intersection, have mitigatingaccidentrisks[1].AutomatedEmergencyBraking beenwidelyimplementedworldwide,especiallyinEuropean (AEB)andFrontCollisionWarning(FCW)canreduceupto countries such as France and UK [9]. In roundabouts, vehi- 29% car crashes and 9% injuries. Lane Departure Warning clesalreadyinsidetypicallyhavetherightofway.Compared (LDW) has shown the capability to reduce crash rates by to vehicle maneuvers on highways, driving behavior within approximately 7% [2]. roundabouts is more complex. Entering and exiting a round- To ensure the reliability and robustness of these function- about often involves high acceleration or deceleration, along alities, comprehensive validation is required. Road testing with substantial steering input over a sustained duration due in real-world environments is a conventional approach [3]. to the curved geometry. However, it is time- and cost-intensive, particularly when In this paper, we propose a deep generative model attempting to accumulate the extensive mileage required for roundabout scenario generation using a Transformer- for safety validation [4]. Moreover, real-world testing poses enhancedConditionalVariationalAutoencoder(CVAE-T).In inherent safety risks to drivers due to the potential malfunc- Section III, we utilize the rounD dataset [10] to construct tioning of unproven systems [5]. An increasingly adopted scenariosbyextractingtrajectoriesoftwointeractingvehicles within a same temporal window. A Transformer-enhanced 1Teaching and Research Area for Mechatronics in Mobile Propulsion, CVAE model with variable Œ≤ scheduling strategy is devel- RWTHAachenUniversity,Germany,{li_li,brinkmann,temmen,eisenbarth,  oped to capture the spatio-temporal patterns of the vehicles ¬©2025IEEE.Thisistheauthor‚ÄôsversionofthepaperacceptedforpublicationinIEEEITSC2025. 5202 tcO 82 ]OR.sc[ 1v17642.0152:viXra --- Page 2 --- and their interaction. In Section IV, experimental results are presented by comparing original scenarios and recon- PortA structed scenarios. Two Key-Performance-Indicators (KPIs) are employed to assess the interactive behavior between vehicles. Finally, the disentanglement and interpretability of the learned latent space are analyzed. In summary, the main contributions of this paper are as PortB PortD follows: ‚Ä¢ We propose a data processing pipeline to extract sce- nario data and condition data from the dataset for CVAEtraining.Themethodisextensibletoroadlayouts beyond roundabouts. PortC ‚Ä¢ We propose a Transformer-enhanced Conditional Varia- tional Autoencoder to capture complex spatio-temporal Fig. 1: Neuweiler roundabout in rounD dataset [10] patterns of interacting vehicles in roundabouts. ‚Ä¢ We evaluate the model by comparing the distribution of two KPIs in original and generated scenarios. Fur- components: a generator and a discriminator. Both are built thermore, a detailed analysis of the learned latent space ondeepneuralnetworksandtrainedinanadversarialprocess demonstratesthemodel‚Äôscapabilitytogeneraterealistic, [15]. The generator learns to produce realistic data from diverse and condition-consistent synthetic scenarios. random noise, while the discriminator learns to distinguish II. RELATEDWORK between real and generated samples by evaluating both dur- A. Roundabout Dataset ingtraining.TrajGANwasproposedtogeneratelanechange scenariosonhighwaysbasedontheadaptionoftheInfoGAN Roundabouts are common traffic elements in urban driv- [16]. Zhang, et al. [17] introduced a scenario generator ing environments, posing unique challenges for trajectory D2Sim, designed to learn human driving behaviors in mixed planning and vehicle control. In recent years, several open- traffic environments using Graph Attention Networks with source datasets have been released with a specific focus on Transformers and GAN. roundabout scenarios. The INTERACTION dataset provides Another common deep generative model is the Varia- traffic data from five different roundabouts at a sampling tionalAutoencoder(VAE).AVAElearnsacontinuouslatent frequency of 10 Hz, comprising 10479 vehicle trajectories representation by optimizing the Evidence Lower BOund in total over more than 360 minutes [11]. Another dataset (ELBO)ofthedatalikelihood[18].Itconsistsofanencoder with three roundabouts in Germany were recorded using a that maps input data to a latent distribution and a decoder drone,capturingover12700trafficparticipantsatasampling that reconstructs samples drawn from this distribution. The frequency of 25 Hz. The resulting dataset, known as the incorporation of a KL-divergence term regularizes the latent rounD dataset, also includes high-definition maps provided space,facilitatingsmoothinterpolationandrobustgenerative in the OpenDRIVE format [10]. The AA dataset contains capabilities across diverse domains. Krajewski, et al. [19] detailed records of both normal and safety-critical driving introduced a Bezier layer in decoder of VAE to ensure the scenarios with the tracking frequency 2.5 Hz [12]. These smoothnessinpositionandspeeddomainoftrajectories.Jiao, datasets offer opportunities and convenience for analyzing etal.[20]proposedabehavior-awareTrajectoryAutoencoder scenarios in roundabouts. (TAE) that leverages a semi-supervised adversarial autoen- B. Deep Generative Models coder to encode driver behaviors into the latent space, such Scenario generation approaches generally fall into two as aggressiveness and intention. categories: knowledge-based and data-driven methods [13] Diffusion Models are generative frameworks that iter- [14].Knowledge-basedapproachesofferhighinterpretability atively transform Gaussian noise into structured data by and realism, leveraging expert-defined rules to construct learningthereverseofapredefinedforwarddiffusionprocess scenarios. However, they suffer from limited diversity and [21].Thisistypicallyachievedviaaparameterizeddenoising high development costs. In contrast, data-driven methods model trained to approximate the posterior distribution of using deep generative models have emerged as a promising cleandatagivennoisyobservations.Guo,etal[22]proposed solution, enabling the automatic generation of diverse target a controllable diffusion model for generating driving scenar- scenarios for function development and testing. These meth- ios, integrating object category and position via bounding ods offer improved scalability and the potential to uncover boxes. A diffusion-based framework for controllable traffic rare or complex traffic interactions by leveraging large-scale scenario generation that jointly synthesizes agent poses, traffic datasets. orientations, and trajectories was introduced by Pronovost, One representative method is the use of Generative Ad- et al [23]. versarial Networks (GANs), which consist of two main However, these methods are insufficient for generating --- Page 3 --- long-term scenarios, often lacking fine-grained trajectory detailsorfocusingonasingleagent.Suchlimitationsreduce their applicability in effectively supporting scenario gener- ation for function development and comprehensive testing. Additionally, roundabout scenarios, which present complex multi-agent interactions, remain underrepresented in existing work. To address this gap, the following section presents the proposed CVAE-T model designed for learning and generating multi-agent scenarios in roundabouts. III. METHODOLOGY A. Data Processing Vehicle 1 Vehicle 2 Original rounDdataset Vehicle 3 Padding VehicleS 1cenario 1 Paddi Pn ag dding Scenario DataùëÜ12 pE on rt tr _y 1 PE on rt tr _y 2 PE orx ti _t 1 PE orx ti _t 2 Condition Dataùê∂12 Vehicle 1 Padding Padding Vehicle 3 Padding 700frames ‚Ä¶ ‚Ä¶ elpmasenO S=(P )700 , P =(cid:0) xt,yt,xt,yt(cid:1) ‚ààR4 (1) t t=1 t 1 1 2 2 Each vehicle has four possible entry and four possible exit ports in the roundabout. Although some vehicles enter and exit at the same port or complete more than one full circle, these cases are rare and not representative of typical roundaboutbehavior.Therefore,thesescenariosareexcluded from this study. Each vehicle has 12 entry‚Äìexit possibilities. Categorical condition data C is derived from the entry‚Äìexit combinations of the two vehicles and the number of unique combinations is computed as: n(n+1) Number of condition categories= (2) 2 ùë∫ where n = 12 and the total number of unique condition categories is 78, resulting in C ‚àà {1,2,...,78}. The ùëÜ12 scenario data are structured with shape (N, 700, 4) and Vehicle 2 the condition data have shape (N, 1), where N denotes the ùê∂12 number of samples. Categories with fewer than 300 samples ùëÜ13 are excluded from the training process. As a result, the valid Original trajectory frames sample size N is 30329, with a total of 28 valid condition Padded frames using the initial/final position categories. To improve training efficiency, the trajectory sequences are downsampled by a factor of 3, reducing the Fig. 2: Data processing pipeline for extracting trajectories in framelengthfrom700to234frames,resultinginatemporal the same temporal window resolution of 3/25s=0.12s. TherounDdatasetwasreleasedin2020asanopen-source B. Conditional Variational Autoencoder dataset for non-commercial use. The Neuweiler roundabout Conditional Variational Autoencoder (CVAE) is a genera- inAachenfromthedataset,asshowninFigure1,isselected tive model that extends the VAE by incorporating additional for this study. It is a four-armed roundabout and each entry- conditional information [25]. This enables the generation of exit arm is named from A to D. data S conditioned on known attributes, which in this Inthisstudy,ascenarioconsistsoftwovehicletrajectories gen study correspond to synthetic scenarios consisting of two concurrently navigating the roundabout with spatial or tem- trajectories in roundabouts. The scenario data S represent poral interactions. To improve data quality for training, all the training data and condition data C denote the categories vehicle trajectories with fewer than 250 frames are removed. of the entry and exit combination. The CVAE introduces a The initial and final frame indices of each vehicle are avail- latent variable z to model the underlying structure and the able in the dataset. Based on this information, two vehicles joint conditional generative process is defined as that appear within the same temporal window are combined together as a scenario. When the temporal overlap between p (S,z|C)=p (S|z,C)¬∑p(z), (3) two vehicles is too short, it will be difficult for the model to Œ∏ Œ∏ learnmeaningfulinteractions.Thus,thetwotrajectorieswith where p(z) = N(0,I) is a standard normal prior. As the anoverlaplengthoffewerthan100framesareexcludedfrom true posterior p (z | S,C) is intractable, CVAE introduces Œ∏ the training data. an encoder q (z | S,C), which approximates it using a œï Since the trajectory lengths of the two vehicles in each variational Gaussian distribution: scenario differ, temporal alignment within a common time q (z|S,C)=N(z;¬µ (S,C),diag(œÉ2(S,C))). (4) window is required. Although generative model can be de- œï œï œï signed to process variable-length input, this often leads to The latent variable z is sampled using the reparameteriza- significantly increased training complexity [24]. As Figure tion trick: 2 shows, a fixed sequence length of 700 frames (28 s) z=¬µ+œÉ‚äôœµ, œµ‚àºN(0,I). (5) is selected to store the trajectories of the two interacting vehicles. From our analysis of the dataset, this duration is where ‚äô denotes element-wise multiplication. The CVAE suitable for capturing the entire trajectories of both vehicles is trained by maximizing the conditional Evidence Lower whilemaintainingareasonabledatasizeforefficienttraining. Bound (ELBO), which balances reconstruction quality and The longitudinal positions xframeID and lateral positions latent space regularization. This objective is implemented as vehicleID yframeID ofthetwovehiclesareextractedandandconcate- alossfunctioncomposedofareconstructionlossandaKull- vehicleID nated to form a matrix S‚ààR700√ó4 as scenarios: back‚ÄìLeibler (KL) divergence loss. The reconstruction loss --- Page 4 --- L measures how closely the decoder‚Äôs output SÀÜ matches In the decoder, scenarios are reconstructed from the latent rec the input data S and is computed using Mean Squared Error variable z and the conditional input. The latent sequence (MSE) between reconstructed and the original scenarios. is first expanded and concatenated with the embedded con- dition, then passed through a GRU layer to capture initial L =‚à•S‚àíSÀÜ‚à•2, (6) temporal dependencies. The same Transformer layers used rec in the encoder are applied in the decoder to further capture where SÀÜ = p (S | z,C) denotes the reconstructed scenario Œ∏ global spatio-temporal patterns across the sequence. Finally, from the decoder. a dense layer outputs continuous trajectory features at each The Kullback‚ÄìLeibler (KL) divergence term encourages time step. the approximate posterior to remain close to the prior distri- bution: L L = 1(cid:88)(cid:0) ¬µ2+œÉ2‚àílogœÉ2‚àí1(cid:1) , (7) KL 2 j j j j=1 whereListhedimensionalityofthelatentspace,and¬µ ,œÉ j j are the output parameters of the encoder. The total loss function used during training is: L =L +Œ≤¬∑L , (8) total rec KL whereŒ≤ isatunableweightthatcontrolstheinfluenceofthe KL divergence. In this study, Œ≤ is gradually increased from 0.4 to 0.8 during training. This annealing strategy allows the modeltofocusinitiallyonreconstruction,delayingtheregu- larizationpressureonthelatentspacetopromotemorestable convergence and a more structured latent representation. C. Model Structure Transformer was originally proposed for sequence mod- eling in natural language processing and are capable of handling time-series data [26]. Furthermore, the integration of Transformer architectures with VAEs has demonstrated strong potential in tasks such as story completion and im- age processing [27] [28]. This approach is also well-suited for multi-agent scenario generation, where vehicle trajecto- ries and interactions rely on spatio-temporal context. Self- attention-based Transformer layers are integrated into the encoder and decoder of the CVAE in this study, to enhance feature extraction from the original scenarios as shown in Figure 3. The encoder of the CVAE takes the scenario data and conditiondataasinput.Sincetheconditionvaluesrangefrom 1 to 78, directly using these integers as numerical inputs would introduce a false ordinal relationship and mislead model training. To address this, the condition data are first passed through an embedding layer, enabling the model to learn dense semantic representations. These embeddings are then concatenated with the scenario data to form a unified input.Aconvolutionallayerisappliedtoextractlocalmotion patterns and subsequently, a bidirectional Gated Recurrent Unit (GRU) captures temporal dependencies in both forward and backward directions. The output is then passed through Transformer layers, followed by global average pooling. Finally, fully connected layers generate the parameters ¬µ and logœÉ2 that define the latent distribution, from which the latent variable is sampled using the reparameterization trick. ùë∫atad oiranecS ùêÇatad noitidnoC Encoder Decoder ùíõ Œº ùùà ùùê noitnettA-fleS drawroF-deeF noitnettA-fleS drawroF-deeF detcurtsnoceR ùë∫atad Fig. 3: Transformer-enhanced Conditional Variational Au- toencoder (CVAE-T) structure D. Model Configuration and Training A total of 70% of the scenarios are randomly selected as trainingdata,15%areusedforvalidationduringtraining,and the remaining 15% are reserved for testing. The Œ≤ value is linearly increased from 0.4 to 0.8 over a warm-up period of 200 epochs. The model is trained using the Adam optimizer with a learning rate of 1 ¬∑ 10‚àí4. The dimensionality of the latent space is set to 20 to ensure sufficient capacity for capturing relevant scenario features while maintaining effective influence of latent variables on the output. For the Transformer architecture, we use a head size of 256, a feed- forward dimension of 512, and 4 attention heads in multi- head attention layer. The model is trained for 400 epochs with a batch size of 32. IV. RESULT A. Reconstruction and Generation Inthissection,weanalyzethereconstructionperformance by comparing the original and reconstructed scenarios. Root Mean Squared Error (RMSE) is implemented here to eval- uate the reconstruction performance. As shown in Table I, the RMSE value indicate that the reconstructed trajectories closely follow the original trajectories over the 28 s duration in a scenario. Given the complexity of roundabout scenarios and the extended temporal span in certain conditions, the RMSE values are considered reasonable. The slight recon- structionerrorisexpectedduetothereparameterizationtrick and the increasing Œ≤ value, both of which introduce con- trolled stochasticity to promote a smooth and generalizable latent space, though at the cost of slightly higher RMSE value. --- Page 5 --- TABLEI:ReconstructionperformanceofproposedCVAE-T model RMSE Vehicle1 Vehicle2 Total Longitudinalpositions(m) 2.3898 2.2864 2.3387 Lateralpositions(m) 1.6851 1.9027 1.7972 Twenty-eight scenarios generated under different condi- tions using the trained model are shown in Fig. 4. The curvature of the generated trajectories indicates that the vehicles are able to successfully navigate the roundabout. For further analysis, one representative condition category is investigated in detail, as shown in Figure 5. In this case, Vehicle1(blue)travelsfromPortCtoPortB,whileVehicle2 moves from Port B to Port D. As the scenario includes both spatio-temporal data of the two vehicles, color transitions from light to dark are used to represent the progression of time. Fig. 5: Comparison of scenarios under the same condition ID: 1 ID: 2 ID: 3 ID: 4 ID: 5 ID: 6 ID: 7 predefinedthresholds[29].TimetoCollision(TTC)estimates ID: 8 ID: 9 ID: 10 ID: 11 ID: 12 ID: 13 ID: 14 the remaining time before a collision would occur if both vehicles maintain their current speed and direction. Post En- croachmentTime(PET)isanothersuitableKPIforscenarios ID: 15 ID: 16 ID: 17 ID: 18 ID: 19 ID: 20 ID: 21 in roundabouts, defined as the time gap between one vehicle leaving and another entering a shared conflict zone where their paths intersect. For both TTC and PET, lower values ID: 22 ID: 23 ID: 24 ID: 25 ID: 26 ID: 27 ID: 28 indicate more critical scenarios. Randomlyselected500originalscenariosfromthedataset and 500 generated scenarios under the same condition are Fig.4:Visualizationofgeneratedroundaboutscenariosunder compared based on TTC and PET values in Figure 5. TTC different conditions iscomputedateachframe,andtheminimumvaluewithinthe scenario is used as the representative value. In the scenarios, By comparing the original scenario and reconstructed a conflict zone is always present, ensuring the availability scenario,thespatio-temporalpatternsareshowntobehighly of a valid PET value. Trajectories outside the roundabout consistent. Additionally, the same condition is used to gen- are not the focus of this work and are therefore excluded erate synthetic scenarios, as illustrated in Figure 5(c) and from the analysis. As shown in Figure 6(a), PET values (d). In the generated scenario, both vehicles enter and exit in the original scenarios predominantly range from 1.5 s to the roundabout as expected. The two generated scenarios 16 s. The generated scenarios exhibit a similar distribution, demonstrate that the model can generate structurally similar although with a higher number of critical cases where PET scenarios while preserving diversity. Vehicles 1 and 2 start is less than 1.5 s. Figure 6(b) presents a scatter plot of PET and end at slightly different positions in the two generated against the corresponding minimum TTC values for each scenarios. The trajectory of Vehicle 2 in Figure 5(c) is scenario. The observed distribution indicates that the model generally lighter in color than in Figure 5(d), indicating is capable of capturing vehicle interactions by replicating that it enters and exits the roundabout earlier. In contrast, realistic patterns in both KPIs. Vehicle1showsthereversebehavior,enteringandexitingthe In addition, the TTC and PET values of the 4 scenarios roundabout later. The green dashed line indicates the frame in Figure 5 were computed and visualized in the scatter whenVehicle2enterstheconflictarea(withinathresholdof plot.Comparedtotheoriginalscenario5(a),Vehicle1enters 5 meters), along with the corresponding position of Vehicle the roundabout later in generated scenario 5(c), resulting in 1. both vehicles having a higher likelihood of collision within the conflict zone. As a result, small PET and minimum B. Key-Performance-Indicators TTC values are observed near the conflict zone. In contrast, Key-Performance-Indicators (KPIs) are commonly used in generated scenario 5(d) Vehicle 2 enters the roundabout to describe the dynamic relationship between two vehicles significantly later, while Vehicle 1 is already approaching and to classify the risk level of traffic situation based on PortBtoexit.ThisleadtoalargePETvalue,whileminimum --- Page 6 --- TTC is reached near Port B with small value. 25 20 15 10 5 0 0 5 10 15 20 25 PET (s) soiranecS fo rebmuN Original Scenarios Generated Scenarios (a) Distribution of PET in original and generated scenarios 25 20 15 10 5 0 0 5 10 15 20 25 PET (s) )s( CTT muminiM Thisdemonstratesthemodel‚Äôsstrongpotentialforgenerat- ing diverse scenarios, such as those involving different entry and exit timings or varying velocity profiles. V. CONCLUSION In this paper, we investigate multi-agent scenario gen- eration in roundabouts. The rounD dataset is selected and scenarios involving two interacting vehicles within the same temporalwindowareextracted.ACVAEisemployedtolearn the trajectories of the two vehicles and their interactions. To enhance the model‚Äôs ability to capture long-term spatio- temporal patterns, Transformer layers are integrated into the CVAE model. Theresultsdemonstratethattheproposedmodeliscapable Original Scenarios of reconstructing original scenarios and generating synthetic Generated Scenarios scenariosbasedongivenconditions.TwoKPIs,namelyTTC Scenario (a) Scenario (b) andPETareemployedtoevaluategenerationperformanceby Scenario (c) Scenario (d) comparing their distributions against those from the original dataset. Furthermore, the disentanglement and intuitiveness of the latent space are analyzed. Two latent dimensions are selected, each demonstrating a clear relationship with the vehicle‚Äôs velocity and roundabout entry timing, respectively. These findings highlight the ability of the proposed model to augment existing datasets with diverse and safety-relevant (b) Scatter plot of PET against minimum TTC in original and scenarios.Inparticular,itenablesthegenerationofcondition- generated scenarios specific scenarios tailored for the training and evaluation of intelligent driving functions such as AEB, FCW and CA. Fig. 6: Comparison of 500 original and 500 generated sce- While the proposed model is capable of generating most narios based on KPIs roundabout scenarios realistically, performance degrades in conditions with insufficient training samples. Moreover, the C. Latent Space Disentanglement and Interpretability proposedCVAE-Tmodelreliessolelyonpositiondata,which In roundabouts, the entry and exit timing as well as limits its ability to generate scenarios with smooth velocity velocity profiles of the interacting vehicles are key factors profiles. Future work will incorporate vehicle acceleration influencing the safety level of the scenarios. Therefore, we profiles, vehicle geometry and environmental elements, such investigate whether the proposed CVAE-T model captures asroadboundaries,toenablethegenerationofmorerealistic such parameters or other relevant parameters. We manually edge-case scenarios. vary one latent dimension from -3 to 3 in steps of 1.5, while keeping all other latent variables fixed at zero. Scenarios REFERENCES are subsequently generated based on these controlled latent inputs. In addition, velocity profiles are computed from [1] M. Aleksa, A. Schaub, I. Erdelean, S. Wittmann, A. Soteropoulos, and A. F√ºrd√∂s, ‚ÄúImpact analysis of advanced driver assistance sys- position data, excluding segments outside the roundabout. tems (adas) regarding road safety ‚Äì computing reduction potentials,‚Äù Five latent parameters exhibit a distinct influence on EuropeanTransportResearchReview,vol.16,p.39,2024. the interactive behavior between the two vehicles in the [2] A.Benson,B.C.Tefft,A.M.Svancara,andW.J.Horrey,‚ÄúPotential reductionsincrashes,injuries,anddeathsfromlarge-scaledeployment generated scenarios. Two representative latent parameters ofAdvancedDriverAssistanceSystems,‚ÄùAAAFoundationforTraffic are here analyzed to explore their influence on scenario Safety,Tech.Rep.,2018,researchBrief. generation. Figure 7(a) illustrates the effect of varying the [3] P. Koopman and M. Wagner, ‚ÄúChallenges in autonomous vehicle 1th latent parameter from -3 to 3 (left to right). While the testing and validation,‚Äù SAE International Journal of Transportation Safety,vol.4,no.1,pp.15‚Äì24,2016. trajectory shape of Vehicle 1 remains relatively constant, [4] W.WachenfeldandH.Winner,‚ÄúThereleaseofautonomousvehicles,‚Äù its velocity profile changes noticeably, particularly at the inAutonomousDriving:TechnicalLegalandSocialAspects. Berlin, roundabout entry. In the first scenario, the velocity is steady, Heidelberg,Germany:SpringerBerlinHeidelberg,2016,pp.425‚Äì449. [5] H. Liu and Y. Feng, ‚ÄúReal world meets virtual world: Augmented whereas in the fifth, the vehicle decelerates before entering reality makes driverless vehicle testing faster, safer, and cheaper,‚Äù theroundaboutandacceleratesafterentry.Figure7(b)shows UniversityofMichigan,Tech.Rep.,2018. the effect of manipulating the 20th latent parameter. As its [6] S. Ulbrich, T. Menzel, A. Reschka, F. Schuldt, and M. Maurer, ‚ÄúDefining and substantiating the terms scene, situation, and scenario value increases, the entry timing of Vehicle 2 is delayed, for automated driving,‚Äù in 2015 IEEE 18th International Conference though the overall velocity profile remains similar. onIntelligentTransportationSystems,2015,pp.982‚Äì988. --- Page 7 --- 40 20 0 ‚àí20 ‚àí40 ‚àí40 ‚àí20 0 20 40 longitudinal position (m) )m( noitisop laretal z0=‚àí3.00 Vehicle 1 Vehicle 2 Frame:114 20 10 0 0 50 100 150 200 Frame Index )s/m( yticoleV z0=‚àí1.50 z0=0.00 z0=1.50 z0=3.00 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 200 Frame:117 Frame:117 Frame:116 Frame:116 20 20 20 20 150 0 0 0 0 100 ‚àí20 ‚àí20 ‚àí20 ‚àí20 50 ‚àí40 ‚àí40 ‚àí40 ‚àí40 0 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 longitudinal position (m) longitudinal position (m) longitudinal position (m) longitudinal position (m) 20 20 20 20 10 10 10 10 0 0 0 0 0 50 100 150 200 0 50 100 150 200 0 50 100 150 200 0 50 100 150 200 Frame Index Frame Index Frame Index Frame Index )1 elciheV( xednI emarF 200 150 100 50 0 )1 elciheV( xednI emarF Vehicle 1 Vehicle 2 (a) Variation of 1st latent parameter 40 20 0 ‚àí20 ‚àí40 ‚àí40 ‚àí20 0 20 40 longitudinal position (m) )m( noitisop laretal z19=‚àí3.00 Vehicle 1 Vehicle 2 Frame:42 20 10 0 0 50 100 150 200 Frame Index )s/m( yticoleV z19=‚àí1.50 z19=0.00 z19=1.50 z19=3.00 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 40 V Ve eh hi ic cl le e 1 2 200 Frame:73 Frame:117 Frame:167 Frame:203 20 20 20 20 150 0 0 0 0 100 ‚àí20 ‚àí20 ‚àí20 ‚àí20 50 ‚àí40 ‚àí40 ‚àí40 ‚àí40 0 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 ‚àí40 ‚àí20 0 20 40 longitudinal position (m) longitudinal position (m) longitudinal position (m) longitudinal position (m) 20 20 20 20 10 10 10 10 0 0 0 0 0 50 100 150 200 0 50 100 150 200 0 50 100 150 200 0 50 100 150 200 Frame Index Frame Index Frame Index Frame Index )1 elciheV( xednI emarF 200 150 100 50 0 )1 elciheV( xednI emarF Vehicle 1 Vehicle 2 (b) Variation of 20th latent parameter Fig. 7: Influence of latent parameter variation on generated scenarios [7] J.Sun,H.Zhang,H.Zhou,R.Yu,andY.Tian,‚ÄúScenario-basedtest [18] D. P. Kingma and M. Welling, ‚ÄúAuto-encoding variational bayes,‚Äù automation for highly automated vehicles: A review and paving the arXiv preprint arXiv:1312.6114, 2014, presented at the International wayforsystematicsafetyassurance,‚ÄùIEEETransactionsonIntelligent ConferenceonLearningRepresentations(ICLR). TransportationSystems,vol.23,no.9,pp.14088‚Äì14103,2022. [19] R. Krajewski, T. Moers, A. Meister, and L. Eckstein, ‚ÄúB√©ziervae: [8] D.Chen,M.Zhu,H.Yang,X.Wang,andY.Wang,‚ÄúData-driventraffic Improved trajectory modeling using variational autoencoders for the simulation:Acomprehensivereview,‚ÄùIEEETransactionsonIntelligent safetyvalidationofhighlyautomatedvehicles,‚Äùin2019IEEEIntelli- Vehicles,vol.9,no.4,pp.4730‚Äì4748,2024. gentTransportationSystemsConference(ITSC),2019,pp.3788‚Äì3795. [9] W.Brilon,‚ÄúStateoftheartofroundaboutperformanceforpromoting [20] R. Jiao, X. Liu, B. Zheng, D. Liang, and Q. Zhu, ‚ÄúTae: A semi- of urban safety,‚Äù Transport and Safety: Systems, Approaches, and supervisedcontrollablebehavior-awaretrajectorygeneratorandpredic- Implementation,pp.147‚Äì164,2021. tor,‚ÄùinProc.IEEE/RSJInternationalConferenceonIntelligentRobots [10] R.Krajewski,T.Moers,J.Bock,L.Vater,andL.Eckstein,‚ÄúTheround andSystems,2022,pp.12534‚Äì12541. dataset: A drone dataset of road user trajectories at roundabouts in [21] Y.SongandS.Ermon,‚ÄúGenerativemodelingbyestimatinggradients germany,‚Äùin2020IEEE23rdInternationalConferenceonIntelligent of the data distribution,‚Äù Advances in neural information processing TransportationSystems(ITSC),2020,pp.1‚Äì6. systems,vol.32,2019. [11] W. Zhan, L. Sun, D. Wang, H. Shi, A. Clausse, M. Naumann et al., [22] Z.Guo,Y.Yu,andC.Gou,‚ÄúControllablediffusionmodelsforsafety- ‚ÄúInteraction dataset: An international, adversarial and cooperative criticaldrivingscenariogeneration,‚Äùin2023IEEE35thInternational motion dataset in interactive driving scenarios with semantic maps,‚Äù Conference on Tools with Artificial Intelligence (ICTAI), 2023, pp. arXivpreprintarXiv:1910.03088,2019. 717‚Äì722. [12] X. Yan, Z. Zou, S. Feng, H. Zhu, H. Sun, and H. X. Liu, ‚ÄúLearn- [23] E. Pronovost, M. R. Ganesina, N. Hendy, Z. Wang, A. Morales, ing naturalistic driving environment with statistical realism,‚Äù Nature K. Wang et al., ‚ÄúScenario diffusion: Controllable driving scenario communications,vol.14,no.1,p.2037,2023. generationwithdiffusion,‚ÄùAdvancesinNeuralInformationProcessing [13] D. Nalic, T. Mihalj, M. B√§umler, M. Lehmann, A. Eichberger, and Systems,vol.36,pp.68873‚Äì68894,2023. S.Bernsteiner,‚ÄúScenariobasedtestingofautomateddrivingsystems: [24] M. Petrovich, M. J. Black, and G. Varol, ‚ÄúAction-conditioned 3d Aliteraturesurvey,‚ÄùinFISITAwebCongress,vol.10,2020,p.1. humanmotionsynthesiswithtransformervae,‚ÄùinProceedingsofthe [14] T. Menzel, G. Bagschik, L. Isensee, A. Schomburg, and M. Maurer, IEEE/CVF International Conference on Computer Vision, 2021, pp. ‚ÄúFrom functional to logical scenarios: Detailing a keyword-based 10985‚Äì10995. scenario description for execution in a simulation environment,‚Äù in [25] D. P. Kingma, S. Mohamed, D. Jimenez Rezende, and M. Welling, 2019 IEEE Intelligent Vehicles Symposium (IV). IEEE, 2019, pp. ‚ÄúSemi-supervisedlearningwithdeepgenerativemodels,‚ÄùAdvancesin 2383‚Äì2390. neuralinformationprocessingsystems,vol.27,2014. [15] I.J.Goodfellow,J.Pouget-Abadie,M.Mirza,B.Xu,D.Warde-Farley, [26] A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. S. Ozair, A. Courville, and Y. Bengio, ‚ÄúGenerative adversarial nets,‚Äù Gomez et al., ‚ÄúAttention is all you need,‚Äù Advances in neural infor- Advancesinneuralinformationprocessingsystems,vol.27,2014. mationprocessingsystems,vol.30,2017. [16] R. Krajewski, T. Moers, D. Nerger, and L. Eckstein, ‚ÄúData-driven [27] T. Wang and X. Wan, ‚ÄúT-cvae: Transformer-based conditioned varia- maneuver modeling using generative adversarial networks and varia- tional autoencoder for story completion.‚Äù in IJCAI, 2019, pp. 5233‚Äì tionalautoencodersforsafetyvalidationofhighlyautomatedvehicles,‚Äù 5239. in 2018 21st International Conference on Intelligent Transportation [28] P.Shamsolmoali,M.Zareapoor,H.Zhou,X.Li,andY.Lu,‚ÄúDistance- Systems(ITSC),2018,pp.2383‚Äì2390. based weighted transformer network for image completion,‚Äù Pattern Recognition,vol.147,p.110120,2024. [17] K.Zhang,C.Chang,W.Zhong,S.Li,Z.Li,andL.Li,‚ÄúAsystematic [29] L. Li, Z. Zhang, Z.-G. Xu, W.-C. Yang, and Q.-C. Lu, ‚ÄúThe role of solution of human driving behavior modeling and simulation for traffic conflicts in roundabout safety evaluation: A review,‚Äù Accident automated vehicle studies,‚Äù IEEE Transactions on Intelligent Trans- Analysis&Prevention,vol.196,p.107430,2024. portationSystems,vol.23,no.11,pp.21944‚Äì21958,2022.